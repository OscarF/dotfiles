#!/usr/bin/env bash

# Logging stuff.
function e_header()   { echo -e "\n\033[1m$@\033[0m"; }
function e_success()  { echo -e " \033[1;32m✔\033[0m  $@"; }
function e_error()    { echo -e " \033[1;31m✖\033[0m  $@"; }
function e_arrow()    { echo -e " \033[1;33m➜\033[0m  $@"; }


# Install Homebrew.
if [[ ! "$(type -P brew)" ]]; then
  e_header "Installing Homebrew"
  true | ruby -e "$(curl -fsSL https://raw.github.com/Homebrew/homebrew/go/install)"

  e_header "Updating Homebrew"
  brew doctor
  brew update
  brew tap homebrew/versions

  # Bash 4
  brew install bash
  # regular bash-completion package is held back to an older release, so we get latest from versions.
  # github.com/Homebrew/homebrew/blob/master/Library/Formula/bash-completion.rb#L3-L4
  brew install homebrew/versions/bash-completion2

  # Set new shell, Bash 4
  sudo -s
  BASHPATH=$(brew --prefix)/bin/bash
  sudo echo $BASHPATH >> /etc/shells
  chsh -s $BASHPATH # will set for current user only.

fi

# Install Homebrew recipes.
e_header "Installing Homebrew recipes"

# Install useful stuff
brew install git
brew install bash-completion # Also get old bash-completion

# Get Brew Cask
brew install caskroom/cask/brew-cask

# Finally clean up
brew cleanup
